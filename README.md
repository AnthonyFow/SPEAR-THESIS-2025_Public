--------------------------------------------
REPOSITORY "SPEAR PUBLIC 2025" 
AUTHOR: ANTHONY JEANPIER FOW ESTEVES
CONTACT: ajfe081@gmail.com
--------------------------------------------

## Project Overview

This repository provides the main analysis script and synthetic example datasets for the thesis:

**"Evaluating the Relationship Between Pesticide Pressure and Macroinvertebrate Bioindicators in Swiss Streams"**

The project quantitatively evaluates whether pesticide effects on macroinvertebrate communities, indicated by the SPEARpesticides index, align with chemical metrics based on risk quotients (RQs) and toxic units (TUs), using data from the Swiss National Surface Water Quality Monitoring Program. Additional bioindicators (e.g., IBCH, EPT) are also evaluated.

---

## Repository Structure

- **/inputs**: Synthetic, randomly generated datasets that closely mimic the structure, column names, and approximate number of observations and rivers in the original data.  
  - `Abiotics_factors_41_streams_ds_prepared.rds`: Abiotic factors for 41 streams (e.g., land use, flow velocity, temperature, etc.).
  - `metrics_3.5d_0_R12_pp_ds.rds`: Chemical metrics (RQs, TUs) and bioindicators (e.g., SPEAR) for 3.5-day composite samples, with realistic scenarios (time windows) and stream assignments.
  - `metrics_14d_0_R12_pp_ds.rds`: Chemical metrics and bioindicators for 14-day composite samples, with full stream coverage and realistic scenarios.
  
- **/scripts**:  
  - `bio_chem_analysis.R`: Main analysis script (statistical modeling, figures, etc.).
  - `datasets_creation.R`: Script to generate or customize the synthetic datasets. Users can modify this freely if they wish to change the structure or parameters.
  
- **/output/graphics**:  
  - Contains main thesis plots and a folder for any new plots generated by users.
  
- **/docs**:  
  - Detailed documentation of all variables and columns in each dataset.

---

## Important Notes on the Data

- **The datasets in `/inputs` are entirely synthetic and randomly generated. They do not contain real observations and cannot be used to reproduce the exact results of the thesis.**
- **Their structure, column names, and approximate number of observations and streams closely replicate the original datasets, ensuring code compatibility and reproducibility of the workflow.**
- **At some point in the analysis, data transformations (e.g., log1p, scaling) are applied. The synthetic datasets are provided in their original, untransformed scale. Please ensure that all required transformations are performed as described in the analysis scripts.**
- **For full details on each variable and dataset structure, refer to the `/docs` folder.**

Due to confidentiality and data access restrictions, **the full datasets and scripts for data extraction, cleaning, and custom function development are not included in this repository**.
The files in `/inputs` are random samples that allow users to run the main analysis and understand the data structure and workflow.

If you require access to the full original datasets or additional scripts, please contact Dr. Anne Dietzel (thesis supervisor) at the VSA office: anne.dietzel@vsa.ch.

---

## Study Summary

Pesticide contamination in streams poses a significant threat to aquatic ecosystems, as evidenced by impacts on macroinvertebrate communities. This study:

- Utilized the SPEARpesticides index alongside other bioindicators and chemical metrics derived from 3.5- and 14-day composite samples.
- Applied rigorous chemical metric selection and flexible statistical modeling to examine the explanatory power and stability of RQs and TUs across different temporal windows.
- Found that both RQs and TUs were negatively associated with SPEARpesticides, confirming that higher pesticide exposure corresponds to declines in sensitive macroinvertebrate taxa, though the strength and consistency of these associations varied.
- Inclusion of environmental parameters such as agricultural land use and flow velocity further improved model performance by up to 60%, highlighting the value of integrated, multi-factor approaches.
- Substantial unexplained variance persisted, especially at the extremes of the exposure gradient, reflecting the complexity of field conditions and data limitations.

---

## How to Use This Repository

1. **Download or clone this repository.**
2. **Ensure you have R installed. All required packages are listed at the top of each script.**
3. **Load the example data (RDS objects preserve all data structures)**
4. **Run the main script in `/scripts/bio_chem_analysis.R` to reproduce the statistical workflow.**
5. **If you wish to modify the synthetic datasets (e.g., change number of streams, scenarios, or distributions), edit and run `/scripts/datasets_creation.R`.**

---

## License and Contact

This repository is published for academic and scientific transparency purposes.  
For additional use, or to request access to the full datasets or data extraction and processing scripts, please contact:

- Dr. Anne Dietzel  
- VSA Office  
- Email: anne.dietzel@vsa.ch

---

## Citation

If you use or adapt this repository, please cite the thesis and/or contact the author.

